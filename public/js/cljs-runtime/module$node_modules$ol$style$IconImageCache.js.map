{
"version":3,
"file":"module$node_modules$ol$style$IconImageCache.js",
"lineCount":63,
"mappings":"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",
"sources":["node_modules/ol/style/IconImageCache.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$ol$style$IconImageCache\"] = function(global,require,module,exports) {\nObject.defineProperties(exports, {__esModule:{enumerable:true, value:true}, default:{enumerable:true, get:function() {\n  return $$default;\n}}, getCacheKey:{enumerable:true, get:function() {\n  return getCacheKey;\n}}, shared:{enumerable:true, get:function() {\n  return shared;\n}}});\nvar require$_DOT__DOT__SLASH_ImageState_DOT_js = require(\"../ImageState.js\");\nvar require$_DOT__DOT__SLASH_color_DOT_js = require(\"../color.js\");\nvar require$_DOT__DOT__SLASH_dom_DOT_js = require(\"../dom.js\");\nvar default$$require$_DOT__DOT__SLASH_ImageState_DOT_js = require.esmDefault(require$_DOT__DOT__SLASH_ImageState_DOT_js);\nclass IconImageCache {\n  constructor() {\n    this.cache_ = {};\n    this.patternCache_ = {};\n    this.cacheSize_ = 0;\n    this.maxCacheSize_ = 1024;\n  }\n  clear() {\n    this.cache_ = {};\n    this.patternCache_ = {};\n    this.cacheSize_ = 0;\n  }\n  canExpireCache() {\n    return this.cacheSize_ > this.maxCacheSize_;\n  }\n  expire() {\n    if (this.canExpireCache()) {\n      let i = 0;\n      for (const key in this.cache_) {\n        const iconImage = this.cache_[key];\n        if ((i++ & 3) === 0 && !iconImage.hasListener()) {\n          delete this.cache_[key];\n          delete this.patternCache_[key];\n          --this.cacheSize_;\n        }\n      }\n    }\n  }\n  get(src, crossOrigin, color) {\n    const key = getCacheKey(src, crossOrigin, color);\n    return key in this.cache_ ? this.cache_[key] : null;\n  }\n  getPattern(src, crossOrigin, color) {\n    const key = getCacheKey(src, crossOrigin, color);\n    return key in this.patternCache_ ? this.patternCache_[key] : null;\n  }\n  set(src, crossOrigin, color, iconImage, pattern) {\n    const key = getCacheKey(src, crossOrigin, color);\n    const update = key in this.cache_;\n    this.cache_[key] = iconImage;\n    if (pattern) {\n      if (iconImage.getImageState() === default$$require$_DOT__DOT__SLASH_ImageState_DOT_js.default.IDLE) {\n        iconImage.load();\n      }\n      if (iconImage.getImageState() === default$$require$_DOT__DOT__SLASH_ImageState_DOT_js.default.LOADING) {\n        iconImage.ready().then(() => {\n          this.patternCache_[key] = (0,require$_DOT__DOT__SLASH_dom_DOT_js.getSharedCanvasContext2D)().createPattern(iconImage.getImage(1), \"repeat\",);\n        });\n      } else {\n        this.patternCache_[key] = (0,require$_DOT__DOT__SLASH_dom_DOT_js.getSharedCanvasContext2D)().createPattern(iconImage.getImage(1), \"repeat\",);\n      }\n    }\n    if (!update) {\n      ++this.cacheSize_;\n    }\n  }\n  setSize(maxCacheSize) {\n    this.maxCacheSize_ = maxCacheSize;\n    this.expire();\n  }\n}\nfunction getCacheKey(src, crossOrigin, color) {\n  const colorString = color ? (0,require$_DOT__DOT__SLASH_color_DOT_js.asArray)(color) : \"null\";\n  return crossOrigin + \":\" + src + \":\" + colorString;\n}\nconst $$default = IconImageCache;\nconst shared = new IconImageCache();\n\n};"],
"names":["shadow$provide","global","require","module","exports","getCacheKey","src","crossOrigin","color","colorString","require$_DOT__DOT__SLASH_color_DOT_js","asArray","Object","defineProperties","__esModule","enumerable","value","default","get","$$default","shared","require$_DOT__DOT__SLASH_ImageState_DOT_js","require$_DOT__DOT__SLASH_dom_DOT_js","default$$require$_DOT__DOT__SLASH_ImageState_DOT_js","esmDefault","IconImageCache","constructor","cache_","patternCache_","cacheSize_","maxCacheSize_","clear","canExpireCache","expire","i","key","iconImage","hasListener","getPattern","set","pattern","update","getImageState","IDLE","load","LOADING","ready","then","getSharedCanvasContext2D","createPattern","getImage","setSize","maxCacheSize"]
}
