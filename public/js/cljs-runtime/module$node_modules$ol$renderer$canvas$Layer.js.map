{
"version":3,
"file":"module$node_modules$ol$renderer$canvas$Layer.js",
"lineCount":119,
"mappings":"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",
"sources":["node_modules/ol/renderer/canvas/Layer.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$ol$renderer$canvas$Layer\"] = function(global,require,module,exports) {\nObject.defineProperties(exports, {__esModule:{enumerable:true, value:true}, canvasPool:{enumerable:true, get:function() {\n  return canvasPool;\n}}, default:{enumerable:true, get:function() {\n  return $$default;\n}}});\nvar require$_DOT__DOT__SLASH__DOT__DOT__SLASH_array_DOT_js = require(\"../../array.js\");\nvar require$_DOT__DOT__SLASH__DOT__DOT__SLASH_color_DOT_js = require(\"../../color.js\");\nvar require$_DOT__DOT__SLASH__DOT__DOT__SLASH_dom_DOT_js = require(\"../../dom.js\");\nvar require$_DOT__DOT__SLASH__DOT__DOT__SLASH_extent_DOT_js = require(\"../../extent.js\");\nvar require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_Event_DOT_js = require(\"../../render/Event.js\");\nvar require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_EventType_DOT_js = require(\"../../render/EventType.js\");\nvar require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_canvas_SLASH_ZIndexContext_DOT_js = require(\"../../render/canvas/ZIndexContext.js\");\nvar require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js = require(\"../../transform.js\");\nvar require$_DOT__DOT__SLASH_Layer_DOT_js = require(\"../Layer.js\");\nvar default$$require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_canvas_SLASH_ZIndexContext_DOT_js = require.esmDefault(require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_canvas_SLASH_ZIndexContext_DOT_js);\nvar default$$require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_Event_DOT_js = require.esmDefault(require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_Event_DOT_js);\nvar default$$require$_DOT__DOT__SLASH_Layer_DOT_js = require.esmDefault(require$_DOT__DOT__SLASH_Layer_DOT_js);\nvar default$$require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_EventType_DOT_js = require.esmDefault(require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_EventType_DOT_js);\nconst canvasPool = [];\nlet pixelContext = null;\nfunction createPixelContext() {\n  pixelContext = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_dom_DOT_js.createCanvasContext2D)(1, 1, undefined, {willReadFrequently:true,});\n}\nclass CanvasLayerRenderer extends default$$require$_DOT__DOT__SLASH_Layer_DOT_js.default {\n  constructor(layer) {\n    super(layer);\n    this.container = null;\n    this.renderedResolution;\n    this.tempTransform = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.create)();\n    this.pixelTransform = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.create)();\n    this.inversePixelTransform = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.create)();\n    this.context = null;\n    this.deferredContext_ = null;\n    this.containerReused = false;\n    this.frameState = null;\n  }\n  getImageData(image, col, row) {\n    if (!pixelContext) {\n      createPixelContext();\n    }\n    pixelContext.clearRect(0, 0, 1, 1);\n    let data;\n    try {\n      pixelContext.drawImage(image, col, row, 1, 1, 0, 0, 1, 1);\n      data = pixelContext.getImageData(0, 0, 1, 1).data;\n    } catch {\n      pixelContext = null;\n      return null;\n    }\n    return data;\n  }\n  getBackground(frameState) {\n    const layer = this.getLayer();\n    let background = layer.getBackground();\n    if (typeof background === \"function\") {\n      background = background(frameState.viewState.resolution);\n    }\n    return background || undefined;\n  }\n  useContainer(target, transform, backgroundColor) {\n    const layerClassName = this.getLayer().getClassName();\n    let container, context;\n    if (target && target.className === layerClassName && (!backgroundColor || target && target.style.backgroundColor && (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_array_DOT_js.equals)((0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_color_DOT_js.asArray)(target.style.backgroundColor), (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_color_DOT_js.asArray)(backgroundColor),))) {\n      const canvas = target.firstElementChild;\n      if (canvas instanceof HTMLCanvasElement) {\n        context = canvas.getContext(\"2d\");\n      }\n    }\n    if (context && context.canvas.style.transform === transform) {\n      this.container = target;\n      this.context = context;\n      this.containerReused = true;\n    } else if (this.containerReused) {\n      this.container = null;\n      this.context = null;\n      this.containerReused = false;\n    } else if (this.container) {\n      this.container.style.backgroundColor = null;\n    }\n    if (!this.container) {\n      container = document.createElement(\"div\");\n      container.className = layerClassName;\n      let style = container.style;\n      style.position = \"absolute\";\n      style.width = \"100%\";\n      style.height = \"100%\";\n      context = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_dom_DOT_js.createCanvasContext2D)();\n      const canvas = context.canvas;\n      container.appendChild(canvas);\n      style = canvas.style;\n      style.position = \"absolute\";\n      style.left = \"0\";\n      style.transformOrigin = \"top left\";\n      this.container = container;\n      this.context = context;\n    }\n    if (!this.containerReused && backgroundColor && !this.container.style.backgroundColor) {\n      this.container.style.backgroundColor = backgroundColor;\n    }\n  }\n  clipUnrotated(context, frameState, extent) {\n    const topLeft = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_extent_DOT_js.getTopLeft)(extent);\n    const topRight = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_extent_DOT_js.getTopRight)(extent);\n    const bottomRight = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_extent_DOT_js.getBottomRight)(extent);\n    const bottomLeft = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_extent_DOT_js.getBottomLeft)(extent);\n    (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.apply)(frameState.coordinateToPixelTransform, topLeft);\n    (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.apply)(frameState.coordinateToPixelTransform, topRight);\n    (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.apply)(frameState.coordinateToPixelTransform, bottomRight);\n    (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.apply)(frameState.coordinateToPixelTransform, bottomLeft);\n    const inverted = this.inversePixelTransform;\n    (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.apply)(inverted, topLeft);\n    (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.apply)(inverted, topRight);\n    (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.apply)(inverted, bottomRight);\n    (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.apply)(inverted, bottomLeft);\n    context.save();\n    context.beginPath();\n    context.moveTo(Math.round(topLeft[0]), Math.round(topLeft[1]));\n    context.lineTo(Math.round(topRight[0]), Math.round(topRight[1]));\n    context.lineTo(Math.round(bottomRight[0]), Math.round(bottomRight[1]));\n    context.lineTo(Math.round(bottomLeft[0]), Math.round(bottomLeft[1]));\n    context.clip();\n  }\n  prepareContainer(frameState, target) {\n    const extent = frameState.extent;\n    const resolution = frameState.viewState.resolution;\n    const rotation = frameState.viewState.rotation;\n    const pixelRatio = frameState.pixelRatio;\n    const width = Math.round((0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_extent_DOT_js.getWidth)(extent) / resolution * pixelRatio);\n    const height = Math.round((0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_extent_DOT_js.getHeight)(extent) / resolution * pixelRatio);\n    (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.compose)(this.pixelTransform, frameState.size[0] / 2, frameState.size[1] / 2, 1 / pixelRatio, 1 / pixelRatio, rotation, -width / 2, -height / 2,);\n    (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.makeInverse)(this.inversePixelTransform, this.pixelTransform);\n    const canvasTransform = (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.toString)(this.pixelTransform);\n    this.useContainer(target, canvasTransform, this.getBackground(frameState));\n    if (!this.containerReused) {\n      const canvas = this.context.canvas;\n      if (canvas.width != width || canvas.height != height) {\n        canvas.width = width;\n        canvas.height = height;\n      } else {\n        this.context.clearRect(0, 0, width, height);\n      }\n      if (canvasTransform !== canvas.style.transform) {\n        canvas.style.transform = canvasTransform;\n      }\n    }\n  }\n  dispatchRenderEvent_(type, context, frameState) {\n    const layer = this.getLayer();\n    if (layer.hasListener(type)) {\n      const event = new default$$require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_Event_DOT_js.default(type, this.inversePixelTransform, frameState, context,);\n      layer.dispatchEvent(event);\n    }\n  }\n  preRender(context, frameState) {\n    this.frameState = frameState;\n    if (frameState.declutter) {\n      return;\n    }\n    this.dispatchRenderEvent_(default$$require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_EventType_DOT_js.default.PRERENDER, context, frameState);\n  }\n  postRender(context, frameState) {\n    if (frameState.declutter) {\n      return;\n    }\n    this.dispatchRenderEvent_(default$$require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_EventType_DOT_js.default.POSTRENDER, context, frameState);\n  }\n  renderDeferredInternal(frameState) {\n  }\n  getRenderContext(frameState) {\n    if (frameState.declutter && !this.deferredContext_) {\n      this.deferredContext_ = new default$$require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_canvas_SLASH_ZIndexContext_DOT_js.default();\n    }\n    return frameState.declutter ? this.deferredContext_.getContext() : this.context;\n  }\n  renderDeferred(frameState) {\n    if (!frameState.declutter) {\n      return;\n    }\n    this.dispatchRenderEvent_(default$$require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_EventType_DOT_js.default.PRERENDER, this.context, frameState,);\n    if (frameState.declutter && this.deferredContext_) {\n      this.deferredContext_.draw(this.context);\n      this.deferredContext_.clear();\n    }\n    this.renderDeferredInternal(frameState);\n    this.dispatchRenderEvent_(default$$require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_EventType_DOT_js.default.POSTRENDER, this.context, frameState,);\n  }\n  getRenderTransform(center, resolution, rotation, pixelRatio, width, height, offsetX,) {\n    const dx1 = width / 2;\n    const dy1 = height / 2;\n    const sx = pixelRatio / resolution;\n    const sy = -sx;\n    const dx2 = -center[0] + offsetX;\n    const dy2 = -center[1];\n    return (0,require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js.compose)(this.tempTransform, dx1, dy1, sx, sy, -rotation, dx2, dy2,);\n  }\n  disposeInternal() {\n    delete this.frameState;\n    super.disposeInternal();\n  }\n}\nconst $$default = CanvasLayerRenderer;\n\n};"],
"names":["shadow$provide","global","require","module","exports","Object","defineProperties","__esModule","enumerable","value","canvasPool","get","default","$$default","require$_DOT__DOT__SLASH__DOT__DOT__SLASH_array_DOT_js","require$_DOT__DOT__SLASH__DOT__DOT__SLASH_color_DOT_js","require$_DOT__DOT__SLASH__DOT__DOT__SLASH_dom_DOT_js","require$_DOT__DOT__SLASH__DOT__DOT__SLASH_extent_DOT_js","require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_Event_DOT_js","require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_EventType_DOT_js","require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_canvas_SLASH_ZIndexContext_DOT_js","require$_DOT__DOT__SLASH__DOT__DOT__SLASH_transform_DOT_js","require$_DOT__DOT__SLASH_Layer_DOT_js","default$$require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_canvas_SLASH_ZIndexContext_DOT_js","esmDefault","default$$require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_Event_DOT_js","default$$require$_DOT__DOT__SLASH_Layer_DOT_js","default$$require$_DOT__DOT__SLASH__DOT__DOT__SLASH_render_SLASH_EventType_DOT_js","pixelContext","CanvasLayerRenderer","constructor","layer","container","renderedResolution","tempTransform","create","pixelTransform","inversePixelTransform","deferredContext_","context","containerReused","frameState","getImageData","image","col","row","createCanvasContext2D","undefined","willReadFrequently","clearRect","data","drawImage","getBackground","background","getLayer","viewState","resolution","useContainer","target","transform","backgroundColor","layerClassName","getClassName","className","style","equals","asArray","canvas","firstElementChild","HTMLCanvasElement","getContext","document","createElement","position","width","height","appendChild","left","transformOrigin","clipUnrotated","extent","topLeft","getTopLeft","topRight","getTopRight","bottomRight","getBottomRight","bottomLeft","getBottomLeft","apply","coordinateToPixelTransform","inverted","save","beginPath","moveTo","Math","round","lineTo","clip","prepareContainer","rotation","pixelRatio","getWidth","getHeight","compose","size","makeInverse","canvasTransform","toString","dispatchRenderEvent_","type","hasListener","event","dispatchEvent","preRender","declutter","PRERENDER","postRender","POSTRENDER","renderDeferredInternal","getRenderContext","renderDeferred","draw","clear","getRenderTransform","center","offsetX","sx","sy","dy2","disposeInternal"]
}
